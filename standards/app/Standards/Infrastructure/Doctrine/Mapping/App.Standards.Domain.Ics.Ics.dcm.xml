<?xml version="1.0" encoding="UTF-8"?>
<doctrine-mapping
	xmlns="http://doctrine-project.org/schemas/orm/doctrine-mapping"
	xmlns:gedmo="http://gediminasm.org/schemas/orm/doctrine-extensions-mapping"
>
	<entity
		name="App\Standards\Domain\Ics\Ics"
		repository-class="Gedmo\Tree\Entity\Repository\NestedTreeRepository"
		table="standards__ics"
	>
		<indexes>
			<index fields="treeLeft"/>
		</indexes>

		<id name="code" type="app.standards.ics.code"/>

		<field name="title"/>

		<field name="description"/>

		<field name="version" type="integer" version="true"/>

		<!-- Gedmo Nested tree -->
		<gedmo:tree type="nested"/>

		<many-to-one
			field="root"
			target-entity="App\Standards\Domain\Ics\Ics"
		>
			<join-column
				name="root_code"
				on-delete="CASCADE"
				referenced-column-name="code"
			/>
			<gedmo:tree-root/>
		</many-to-one>

		<many-to-one
			field="parent"
			target-entity="App\Standards\Domain\Ics\Ics"
		>
			<join-column
				name="parent_code"
				on-delete="CASCADE"
				referenced-column-name="code"
			/>
			<gedmo:tree-parent/>
		</many-to-one>

		<field name="treeLeft" type="integer">
			<gedmo:tree-left/>
		</field>

		<field name="treeRight" type="integer">
			<gedmo:tree-right/>
		</field>

		<field name="treeLevel" type="integer">
			<gedmo:tree-level/>
		</field>
	</entity>
</doctrine-mapping>
